# Day 5: ì „ì²´ í†µí•© ë° í…ŒìŠ¤íŠ¸ (ì´ˆê¸‰ììš©)

## ğŸ¯ ì˜¤ëŠ˜ì˜ ëª©í‘œ
- ëª¨ë“  ê¸°ëŠ¥ì´ ì œëŒ€ë¡œ ì—°ê²°ë˜ëŠ”ì§€ í™•ì¸í•˜ê¸°
- ì‚¬ìš©ì ì‹œë‚˜ë¦¬ì˜¤ í…ŒìŠ¤íŠ¸í•˜ê¸°
- ë²„ê·¸ ìˆ˜ì • ë° ê°œì„ í•˜ê¸°
- ê°„ë‹¨í•œ Docker ì„¤ì •í•˜ê¸°

## 1. ì „ì²´ ì‹œìŠ¤í…œ ì ê²€

### 1-1. ì„œë¹„ìŠ¤ ìƒíƒœ í™•ì¸ âœ…
```bash
# ê° ì„œë¹„ìŠ¤ê°€ ì •ìƒ ì‹¤í–‰ë˜ëŠ”ì§€ í™•ì¸

# 1. ë°ì´í„°ë² ì´ìŠ¤ (MySQL)
mysql -u root -p
USE smart_learning_db;
SHOW TABLES;

# 2. AI ì„œë¹„ìŠ¤ (Python)
curl http://localhost:8000/health

# 3. Backend ì„œë¹„ìŠ¤ (Spring Boot)
curl http://localhost:8080/actuator/health

# 4. Frontend ì„œë¹„ìŠ¤ (React)
# ë¸Œë¼ìš°ì €ì—ì„œ http://localhost:3000 ì ‘ì†
```

### 1-2. ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸” í™•ì¸ ğŸ—„ï¸
```sql
-- ì‚¬ìš©ì í…Œì´ë¸” í™•ì¸
SELECT COUNT(*) FROM users;
SELECT * FROM users LIMIT 3;

-- íŒŒì¼ í…Œì´ë¸” í™•ì¸
SELECT COUNT(*) FROM uploaded_files;
SELECT * FROM uploaded_files LIMIT 3;

-- ì±„íŒ… ê¸°ë¡ í…Œì´ë¸” í™•ì¸
SELECT COUNT(*) FROM chat_history;
SELECT * FROM chat_history ORDER BY created_at DESC LIMIT 5;
```

## 2. í†µí•© í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤

### 2-1. ì™„ì „í•œ ì‚¬ìš©ì ì‹œë‚˜ë¦¬ì˜¤ í…ŒìŠ¤íŠ¸ ğŸ“

**ì‹œë‚˜ë¦¬ì˜¤ 1: ìƒˆ ì‚¬ìš©ì ê°€ì…ë¶€í„° AI ì±„íŒ…ê¹Œì§€**

1. **íšŒì›ê°€ì…**
   - [ ] ì´ë©”ì¼: `test@example.com`
   - [ ] ë¹„ë°€ë²ˆí˜¸: `123456`
   - [ ] ì´ë¦„: `í…ŒìŠ¤íŠ¸ ì‚¬ìš©ì`
   - [ ] íšŒì›ê°€ì… ì„±ê³µ ë©”ì‹œì§€ í™•ì¸

2. **ë¡œê·¸ì¸**
   - [ ] ìœ„ ì •ë³´ë¡œ ë¡œê·¸ì¸ ì‹œë„
   - [ ] ëŒ€ì‹œë³´ë“œë¡œ ì´ë™ í™•ì¸
   - [ ] ì‚¬ìš©ì ì´ë¦„ í‘œì‹œ í™•ì¸

3. **íŒŒì¼ ì—…ë¡œë“œ**
   - [ ] ê°„ë‹¨í•œ í…ìŠ¤íŠ¸ íŒŒì¼ ìƒì„± ë° ì—…ë¡œë“œ
   - [ ] íŒŒì¼ ëª©ë¡ì— í‘œì‹œ í™•ì¸
   - [ ] íŒŒì¼ í¬ê¸° ë° ë‚ ì§œ ì •ë³´ í™•ì¸

4. **AI ì±„íŒ…**
   - [ ] AI ì±„íŒ… íƒ­ìœ¼ë¡œ ì´ë™
   - [ ] ì—…ë¡œë“œí•œ íŒŒì¼ ì„ íƒ
   - [ ] "ì´ ë¬¸ì„œì˜ ë‚´ìš©ì„ ìš”ì•½í•´ì£¼ì„¸ìš”" ì§ˆë¬¸
   - [ ] AI ì‘ë‹µ í™•ì¸
   - [ ] ì±„íŒ… ê¸°ë¡ ì €ì¥ í™•ì¸

5. **íŒŒì¼ ì‚­ì œ**
   - [ ] íŒŒì¼ ëª©ë¡ì—ì„œ íŒŒì¼ ì‚­ì œ
   - [ ] ëª©ë¡ì—ì„œ ì œê±° í™•ì¸
   - [ ] ì‹¤ì œ íŒŒì¼ ì‚­ì œ í™•ì¸

### 2-2. í…ŒìŠ¤íŠ¸ìš© íŒŒì¼ ìƒì„± ğŸ“„
```bash
# í…ŒìŠ¤íŠ¸ìš© í…ìŠ¤íŠ¸ íŒŒì¼ ìƒì„±
cat > test-document.txt << EOF
ì¸ê³µì§€ëŠ¥ê³¼ ë¨¸ì‹ ëŸ¬ë‹

1. ì¸ê³µì§€ëŠ¥ ê°œìš”
ì¸ê³µì§€ëŠ¥(AI)ì€ ì¸ê°„ì˜ ì§€ëŠ¥ì„ ëª¨ë°©í•˜ëŠ” ì»´í“¨í„° ì‹œìŠ¤í…œì…ë‹ˆë‹¤.
ì£¼ìš” íŠ¹ì§•ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:
- í•™ìŠµ ëŠ¥ë ¥
- ë¬¸ì œ í•´ê²° ëŠ¥ë ¥
- ì–¸ì–´ ì´í•´ ëŠ¥ë ¥

2. ë¨¸ì‹ ëŸ¬ë‹
ë¨¸ì‹ ëŸ¬ë‹ì€ AIì˜ í•œ ë¶„ì•¼ë¡œ, ë°ì´í„°ë¥¼ í†µí•´ í•™ìŠµí•˜ëŠ” ì•Œê³ ë¦¬ì¦˜ì…ë‹ˆë‹¤.
ì¢…ë¥˜:
- ì§€ë„ í•™ìŠµ (Supervised Learning)
- ë¹„ì§€ë„ í•™ìŠµ (Unsupervised Learning)
- ê°•í™” í•™ìŠµ (Reinforcement Learning)

3. ì‘ìš© ë¶„ì•¼
- ìì—°ì–´ ì²˜ë¦¬
- ì»´í“¨í„° ë¹„ì „
- ìŒì„± ì¸ì‹
- ì¶”ì²œ ì‹œìŠ¤í…œ

ì´ëŸ¬í•œ ê¸°ìˆ ë“¤ì€ í˜„ì¬ ìš°ë¦¬ ìƒí™œì˜ ë§ì€ ë¶€ë¶„ì—ì„œ í™œìš©ë˜ê³  ìˆìŠµë‹ˆë‹¤.
EOF
```

### 2-3. API ì—”ë“œí¬ì¸íŠ¸ í…ŒìŠ¤íŠ¸ ğŸ”Œ
```bash
# Postman ë˜ëŠ” curlë¡œ ê° API í…ŒìŠ¤íŠ¸

# 1. íšŒì›ê°€ì… í…ŒìŠ¤íŠ¸
curl -X POST http://localhost:8080/api/auth/register \
  -H "Content-Type: application/json" \
  -d '{
    "email": "test@example.com",
    "password": "123456",
    "name": "í…ŒìŠ¤íŠ¸ ì‚¬ìš©ì"
  }'

# 2. ë¡œê·¸ì¸ í…ŒìŠ¤íŠ¸
curl -X POST http://localhost:8080/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{
    "email": "test@example.com",
    "password": "123456"
  }'

# 3. AI ì±„íŒ… í…ŒìŠ¤íŠ¸
curl -X POST http://localhost:8080/api/ai/chat \
  -H "Content-Type: application/json" \
  -d '{
    "question": "ì•ˆë…•í•˜ì„¸ìš”!",
    "userId": 1
  }'

# 4. AI ì„œë¹„ìŠ¤ ì§ì ‘ í…ŒìŠ¤íŠ¸
curl -X POST http://localhost:8000/chat \
  -H "Content-Type: application/json" \
  -d '{
    "question": "ì•ˆë…•í•˜ì„¸ìš”!",
    "user_id": 1
  }'
```

## 3. ë²„ê·¸ ìˆ˜ì • ë° ê°œì„ 

### 3-1. ìì£¼ ë°œìƒí•˜ëŠ” ë¬¸ì œì™€ í•´ê²°ë²• ğŸ”§

**ë¬¸ì œ 1: AI ì„œë¹„ìŠ¤ ì—°ê²° ì‹¤íŒ¨**
```python
# ai-module/main.py - ì—°ê²° ìƒíƒœ ë¡œê¹… ì¶”ê°€
import logging

logging.basicConfig(level=logging.INFO)
logger = logging.getLogger(__name__)

@app.post("/chat")
async def chat_with_ai(request: ChatRequest):
    logger.info(f"ì±„íŒ… ìš”ì²­ ë°›ìŒ: ì‚¬ìš©ì {request.user_id}")
    try:
        # ê¸°ì¡´ ì½”ë“œ...
        logger.info("OpenAI API í˜¸ì¶œ ì„±ê³µ")
        return ChatResponse(answer=answer, success=True)
    except Exception as e:
        logger.error(f"ì±„íŒ… ì˜¤ë¥˜: {str(e)}")
        return ChatResponse(
            answer="ì£„ì†¡í•©ë‹ˆë‹¤. ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.",
            success=False,
            message=str(e)
        )
```

**ë¬¸ì œ 2: íŒŒì¼ ì—…ë¡œë“œ í›„ ì±„íŒ… ì•ˆë¨**
```java
// backend - íŒŒì¼ ê²½ë¡œ ì²˜ë¦¬ ê°œì„ 
@Service
public class FileService {
    
    public String getFileContent(String filePath) {
        try {
            // ì ˆëŒ€ ê²½ë¡œë¡œ ë³€í™˜
            Path path = Paths.get(filePath).toAbsolutePath();
            
            if (!Files.exists(path)) {
                System.out.println("íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŒ: " + path);
                return "";
            }
            
            // íŒŒì¼ í¬ê¸° ì œí•œ (5MB)
            if (Files.size(path) > 5 * 1024 * 1024) {
                return "íŒŒì¼ì´ ë„ˆë¬´ í½ë‹ˆë‹¤. (5MB ì œí•œ)";
            }
            
            return Files.readString(path, StandardCharsets.UTF_8);
            
        } catch (Exception e) {
            System.out.println("íŒŒì¼ ì½ê¸° ì˜¤ë¥˜: " + e.getMessage());
            return "íŒŒì¼ì„ ì½ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.";
        }
    }
}
```

**ë¬¸ì œ 3: React ì±„íŒ… í™”ë©´ ìŠ¤í¬ë¡¤ ë¬¸ì œ**
```javascript
// frontend - ìë™ ìŠ¤í¬ë¡¤ ê°œì„ 
const ChatInterface = ({ user, selectedFile }) => {
  const messagesEndRef = useRef(null);
  const [messages, setMessages] = useState([]);

  // ë©”ì‹œì§€ ì¶”ê°€ í›„ ìŠ¤í¬ë¡¤
  useEffect(() => {
    if (messagesEndRef.current) {
      messagesEndRef.current.scrollIntoView({ 
        behavior: 'smooth',
        block: 'end'
      });
    }
  }, [messages]);

  // ì»´í¬ë„ŒíŠ¸ ë§ˆìš´íŠ¸ ì‹œì—ë„ ìŠ¤í¬ë¡¤
  useEffect(() => {
    setTimeout(() => {
      if (messagesEndRef.current) {
        messagesEndRef.current.scrollIntoView({ behavior: 'auto' });
      }
    }, 100);
  }, []);

  // ë‚˜ë¨¸ì§€ ì½”ë“œ...
};
```

### 3-2. ì‚¬ìš©ì ê²½í—˜ ê°œì„  âœ¨

**ê°œì„  1: ë¡œë”© ìƒíƒœ ê°œì„ **
```javascript
// frontend/src/components/chat/ChatInterface.js - ê°œì„ ëœ ë¡œë”©
const ChatInterface = ({ user, selectedFile }) => {
  const [isTyping, setIsTyping] = useState(false);
  
  const sendMessage = async () => {
    // ì‚¬ìš©ì ë©”ì‹œì§€ ì¦‰ì‹œ í‘œì‹œ
    const userMessage = {
      type: 'user',
      content: currentMessage,
      timestamp: new Date()
    };
    setMessages(prev => [...prev, userMessage]);
    setCurrentMessage('');
    
    // íƒ€ì´í•‘ ì¸ë””ì¼€ì´í„° í‘œì‹œ
    setIsTyping(true);
    
    try {
      const response = await aiService.chat(currentMessage, user.id, selectedFile?.id);
      
      const aiMessage = {
        type: 'ai',
        content: response.data.answer,
        timestamp: new Date()
      };
      setMessages(prev => [...prev, aiMessage]);
      
    } catch (error) {
      // ì—ëŸ¬ ë©”ì‹œì§€ë„ ì±„íŒ…ì— í‘œì‹œ
      const errorMessage = {
        type: 'error',
        content: 'ì£„ì†¡í•©ë‹ˆë‹¤. ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.',
        timestamp: new Date()
      };
      setMessages(prev => [...prev, errorMessage]);
    } finally {
      setIsTyping(false);
    }
  };

  // íƒ€ì´í•‘ ì¸ë””ì¼€ì´í„° ì»´í¬ë„ŒíŠ¸
  const TypingIndicator = () => (
    <div className="message ai">
      <div className="message-avatar">ğŸ¤–</div>
      <div className="message-content">
        <div className="typing-dots">
          <span></span>
          <span></span>
          <span></span>
        </div>
      </div>
    </div>
  );

  return (
    <div className="chat-interface">
      {/* ê¸°ì¡´ ì½”ë“œ... */}
      <div className="chat-messages">
        {messages.map((message, index) => (
          <ChatMessage key={index} message={message} />
        ))}
        {isTyping && <TypingIndicator />}
        <div ref={messagesEndRef} />
      </div>
      {/* ê¸°ì¡´ ì½”ë“œ... */}
    </div>
  );
};
```

**ê°œì„  2: ì—ëŸ¬ ì²˜ë¦¬ ê°•í™”**
```javascript
// frontend/src/services/api.js - ê¸€ë¡œë²Œ ì—ëŸ¬ ì²˜ë¦¬
import axios from 'axios';

const api = axios.create({
  baseURL: 'http://localhost:8080/api',
  timeout: 30000, // 30ì´ˆ íƒ€ì„ì•„ì›ƒ
});

// ì—ëŸ¬ ì¸í„°ì…‰í„° ê°œì„ 
api.interceptors.response.use(
  (response) => response,
  (error) => {
    let errorMessage = 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.';
    
    if (error.code === 'ECONNABORTED') {
      errorMessage = 'ìš”ì²­ ì‹œê°„ì´ ì´ˆê³¼ë˜ì—ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.';
    } else if (error.response) {
      const { status, data } = error.response;
      
      switch (status) {
        case 400:
          errorMessage = data.message || 'ì˜ëª»ëœ ìš”ì²­ì…ë‹ˆë‹¤.';
          break;
        case 401:
          errorMessage = 'ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.';
          // ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸
          window.location.href = '/login';
          break;
        case 403:
          errorMessage = 'ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤.';
          break;
        case 404:
          errorMessage = 'ìš”ì²­í•˜ì‹  ë¦¬ì†ŒìŠ¤ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.';
          break;
        case 500:
          errorMessage = 'ì„œë²„ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.';
          break;
        default:
          errorMessage = data.message || `ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. (${status})`;
      }
    } else if (error.request) {
      errorMessage = 'ì„œë²„ì— ì—°ê²°í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë„¤íŠ¸ì›Œí¬ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.';
    }
    
    console.error('API ì˜¤ë¥˜:', error);
    return Promise.reject(new Error(errorMessage));
  }
);

export default api;
```

**ê°œì„  3: íŒŒì¼ ì—…ë¡œë“œ ì§„í–‰ë¥ **
```javascript
// frontend/src/components/file/FileUpload.js - ì§„í–‰ë¥  í‘œì‹œ
const FileUpload = ({ userId, onUploadSuccess }) => {
  const [uploadProgress, setUploadProgress] = useState(0);
  
  const handleUpload = async () => {
    if (!selectedFile) return;
    
    const formData = new FormData();
    formData.append('file', selectedFile);
    formData.append('userId', userId);
    
    try {
      const response = await api.post('/files/upload', formData, {
        headers: { 'Content-Type': 'multipart/form-data' },
        onUploadProgress: (progressEvent) => {
          const progress = Math.round(
            (progressEvent.loaded * 100) / progressEvent.total
          );
          setUploadProgress(progress);
        }
      });
      
      if (response.data.success) {
        setAlert({ type: 'success', message: 'íŒŒì¼ ì—…ë¡œë“œ ì™„ë£Œ!' });
        onUploadSuccess(response.data.data);
      }
    } catch (error) {
      setAlert({ type: 'error', message: error.message });
    } finally {
      setUploadProgress(0);
    }
  };

  return (
    <div className="file-upload-container">
      {/* ê¸°ì¡´ ì½”ë“œ... */}
      
      {uploadProgress > 0 && (
        <div className="upload-progress">
          <div className="progress-bar">
            <div 
              className="progress-fill" 
              style={{ width: `${uploadProgress}%` }}
            ></div>
          </div>
          <span className="progress-text">{uploadProgress}% ì—…ë¡œë“œ ì¤‘...</span>
        </div>
      )}
      
      {/* ê¸°ì¡´ ì½”ë“œ... */}
    </div>
  );
};
```

## 4. ì„±ëŠ¥ ìµœì í™”

### 4-1. Frontend ìµœì í™” âš¡
```javascript
// React ì»´í¬ë„ŒíŠ¸ ë©”ëª¨ì´ì œì´ì…˜
import React, { memo, useMemo } from 'react';

// ë©”ì‹œì§€ ì»´í¬ë„ŒíŠ¸ ìµœì í™”
const ChatMessage = memo(({ message }) => {
  const formattedTime = useMemo(() => {
    return new Date(message.timestamp).toLocaleTimeString();
  }, [message.timestamp]);

  return (
    <div className={`message ${message.type}`}>
      <div className="message-avatar">
        {message.type === 'user' ? 'ğŸ‘¤' : 'ğŸ¤–'}
      </div>
      <div className="message-content">
        <div className="message-text">{message.content}</div>
        <div className="message-time">{formattedTime}</div>
      </div>
    </div>
  );
});

// íŒŒì¼ ëª©ë¡ ì»´í¬ë„ŒíŠ¸ ìµœì í™”
const FileList = memo(({ userId, refreshTrigger }) => {
  // ê¸°ì¡´ ì½”ë“œ...
});
```

### 4-2. Backend ìµœì í™” âš¡
```java
// ë°ì´í„°ë² ì´ìŠ¤ ì¿¼ë¦¬ ìµœì í™”
@Repository
public interface ChatHistoryRepository extends JpaRepository<ChatHistory, Long> {
    
    // í˜ì´ì§• ì¶”ê°€
    @Query("SELECT c FROM ChatHistory c WHERE c.userId = :userId ORDER BY c.createdAt DESC")
    Page<ChatHistory> findByUserIdOrderByCreatedAtDesc(
        @Param("userId") Long userId, 
        Pageable pageable
    );
    
    // í•„ìš”í•œ í•„ë“œë§Œ ì¡°íšŒ
    @Query("SELECT new com.smartlearning.dto.ChatSummary(c.id, c.question, c.answer, c.createdAt) " +
           "FROM ChatHistory c WHERE c.userId = :userId ORDER BY c.createdAt DESC")
    List<ChatSummary> findChatSummaryByUserId(@Param("userId") Long userId, Pageable pageable);
}

// ìºì‹± ì¶”ê°€
@Service
@Transactional
public class ChatService {
    
    @Cacheable(value = "chatHistory", key = "#userId")
    public List<ChatHistory> getRecentChatHistory(Long userId) {
        return chatHistoryRepository.findTop10ByUserIdOrderByCreatedAtDesc(userId);
    }
    
    @CacheEvict(value = "chatHistory", key = "#userId")
    public ChatHistory saveChat(ChatHistory chat) {
        return chatHistoryRepository.save(chat);
    }
}
```

### 4-3. AI ì„œë¹„ìŠ¤ ìµœì í™” âš¡
```python
# ai-module/main.py - ì‘ë‹µ ìºì‹± ë° ìµœì í™”
from functools import lru_cache
import hashlib

# ê°„ë‹¨í•œ ìºì‹œ (ì‹¤ì œë¡œëŠ” Redis ì‚¬ìš© ê¶Œì¥)
response_cache = {}

@app.post("/chat", response_model=ChatResponse)
async def chat_with_ai(request: ChatRequest):
    try:
        # ìºì‹œ í‚¤ ìƒì„±
        cache_key = hashlib.md5(
            f"{request.question}_{request.file_content}".encode()
        ).hexdigest()
        
        # ìºì‹œëœ ì‘ë‹µ í™•ì¸
        if cache_key in response_cache:
            print(f"ìºì‹œëœ ì‘ë‹µ ë°˜í™˜: {cache_key}")
            cached_response = response_cache[cache_key]
            return ChatResponse(
                answer=cached_response,
                success=True,
                message="ìºì‹œëœ ì‘ë‹µ"
            )
        
        # OpenAI API í˜¸ì¶œ (í† í° ìˆ˜ ìµœì í™”)
        system_message = "ë‹¹ì‹ ì€ ë„ì›€ì´ ë˜ëŠ” AI í•™ìŠµ ë„ìš°ë¯¸ì…ë‹ˆë‹¤. í•œêµ­ì–´ë¡œ ê°„ê²°í•˜ê²Œ ë‹µë³€í•´ì£¼ì„¸ìš”."
        
        if request.file_content:
            # íŒŒì¼ ë‚´ìš©ì„ 1000ìë¡œ ì œí•œ
            truncated_content = request.file_content[:1000]
            system_message += f"\n\në¬¸ì„œ ë‚´ìš©: {truncated_content}"
        
        response = openai.ChatCompletion.create(
            model="gpt-3.5-turbo",
            messages=[
                {"role": "system", "content": system_message},
                {"role": "user", "content": request.question}
            ],
            max_tokens=300,  # í† í° ìˆ˜ ì œí•œ
            temperature=0.7
        )
        
        answer = response.choices[0].message.content
        
        # ì‘ë‹µ ìºì‹± (ê°„ë‹¨í•œ ì§ˆë¬¸ë§Œ)
        if len(request.question) < 50 and not request.file_content:
            response_cache[cache_key] = answer
            
            # ìºì‹œ í¬ê¸° ì œí•œ
            if len(response_cache) > 100:
                # ê°€ì¥ ì˜¤ë˜ëœ í•­ëª© ì œê±°
                oldest_key = next(iter(response_cache))
                del response_cache[oldest_key]
        
        return ChatResponse(
            answer=answer,
            success=True,
            message="AI ì‘ë‹µ ìƒì„± ì™„ë£Œ"
        )
        
    except Exception as e:
        print(f"AI ì±„íŒ… ì˜¤ë¥˜: {str(e)}")
        return ChatResponse(
            answer="ì£„ì†¡í•©ë‹ˆë‹¤. ì¼ì‹œì ì¸ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.",
            success=False,
            message=str(e)
        )

# í—¬ìŠ¤ì²´í¬ ê°œì„ 
@app.get("/health")
def health_check():
    """ìƒì„¸í•œ í—¬ìŠ¤ì²´í¬"""
    try:
        # OpenAI API í‚¤ í™•ì¸
        api_key_valid = bool(openai.api_key and len(openai.api_key) > 10)
        
        return {
            "status": "healthy",
            "service": "AI Learning Assistant",
            "version": "1.0.0",
            "openai_configured": api_key_valid,
            "cache_size": len(response_cache),
            "timestamp": str(datetime.now())
        }
    except Exception as e:
        return {
            "status": "unhealthy",
            "error": str(e),
            "timestamp": str(datetime.now())
        }
```

## 5. ê°„ë‹¨í•œ Docker ì„¤ì •

### 5-1. AI ì„œë¹„ìŠ¤ Docker ì„¤ì • ğŸ³
```dockerfile
# ai-module/Dockerfile
FROM python:3.11-slim

WORKDIR /app

# ì‹œìŠ¤í…œ íŒ¨í‚¤ì§€ ì„¤ì¹˜
RUN apt-get update && apt-get install -y \
    build-essential \
    curl \
    && rm -rf /var/lib/apt/lists/*

# Python ì˜ì¡´ì„± ì„¤ì¹˜
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

# ì•± ì½”ë“œ ë³µì‚¬
COPY . .

# í¬íŠ¸ ë…¸ì¶œ
EXPOSE 8000

# í™˜ê²½ë³€ìˆ˜ ì„¤ì •
ENV PYTHONPATH=/app
ENV PYTHONUNBUFFERED=1

# í—¬ìŠ¤ì²´í¬
HEALTHCHECK --interval=30s --timeout=10s --start-period=30s --retries=3 \
    CMD curl -f http://localhost:8000/health || exit 1

# ì•± ì‹¤í–‰
CMD ["python", "main.py"]
```

### 5-2. Backend Docker ì„¤ì • ğŸ³
```dockerfile
# backend/Dockerfile
FROM openjdk:17-jdk-slim

WORKDIR /app

# ì‹œìŠ¤í…œ íŒ¨í‚¤ì§€ ì„¤ì¹˜
RUN apt-get update && apt-get install -y curl && rm -rf /var/lib/apt/lists/*

# JAR íŒŒì¼ ë³µì‚¬ (ë¯¸ë¦¬ ë¹Œë“œëœ ê²ƒ)
COPY target/smart-learning-backend-1.0.0.jar app.jar

# ì—…ë¡œë“œ ë””ë ‰í† ë¦¬ ìƒì„±
RUN mkdir -p uploads

# í¬íŠ¸ ë…¸ì¶œ
EXPOSE 8080

# í™˜ê²½ë³€ìˆ˜
ENV SPRING_PROFILES_ACTIVE=docker
ENV JAVA_OPTS="-Xmx512m -Xms256m"

# í—¬ìŠ¤ì²´í¬
HEALTHCHECK --interval=30s --timeout=10s --start-period=60s --retries=3 \
    CMD curl -f http://localhost:8080/actuator/health || exit 1

# ì•± ì‹¤í–‰
ENTRYPOINT ["sh", "-c", "java $JAVA_OPTS -jar app.jar"]
```

### 5-3. ê°„ë‹¨í•œ Docker Compose ğŸ³
```yaml
# docker-compose.yml
version: '3.8'

services:
  # ë°ì´í„°ë² ì´ìŠ¤
  database:
    image: mysql:8.0
    container_name: smart-learning-db
    environment:
      MYSQL_ROOT_PASSWORD: root_password
      MYSQL_DATABASE: smart_learning_db
      MYSQL_USER: app_user
      MYSQL_PASSWORD: app_password
    ports:
      - "3306:3306"
    volumes:
      - db_data:/var/lib/mysql
    healthcheck:
      test: ["CMD", "mysqladmin", "ping", "-h", "localhost"]
      timeout: 20s
      retries: 10

  # AI ì„œë¹„ìŠ¤
  ai-service:
    build: ./ai-module
    container_name: smart-learning-ai
    environment:
      - OPENAI_API_KEY=${OPENAI_API_KEY}
    ports:
      - "8000:8000"
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8000/health"]
      interval: 30s
      timeout: 10s
      retries: 3
    restart: unless-stopped

  # Backend ì„œë¹„ìŠ¤
  backend:
    build: ./backend
    container_name: smart-learning-backend
    environment:
      - SPRING_PROFILES_ACTIVE=docker
      - DB_HOST=database
      - DB_USER=app_user
      - DB_PASSWORD=app_password
      - AI_SERVICE_URL=http://ai-service:8000
    ports:
      - "8080:8080"
    depends_on:
      database:
        condition: service_healthy
      ai-service:
        condition: service_healthy
    volumes:
      - backend_uploads:/app/uploads
    restart: unless-stopped

  # Frontend (í”„ë¡œë•ì…˜ìš©)
  frontend:
    build: ./frontend
    container_name: smart-learning-frontend
    ports:
      - "80:80"
    depends_on:
      - backend
    restart: unless-stopped

volumes:
  db_data:
  backend_uploads:
```

### 5-4. í™˜ê²½ë³€ìˆ˜ íŒŒì¼ ğŸ”‘
```bash
# .env íŒŒì¼ ìƒì„±
cat > .env << EOF
# OpenAI API í‚¤
OPENAI_API_KEY=your-openai-api-key-here

# ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì •
DB_ROOT_PASSWORD=root_password
DB_NAME=smart_learning_db
DB_USER=app_user
DB_PASSWORD=app_password

# JWT ì„¤ì •
JWT_SECRET=your-jwt-secret-key-here
EOF
```

## 6. ìµœì¢… í…ŒìŠ¤íŠ¸ ì²´í¬ë¦¬ìŠ¤íŠ¸

### 6-1. ê¸°ëŠ¥ë³„ í…ŒìŠ¤íŠ¸ âœ…

**ì¸ì¦ ì‹œìŠ¤í…œ:**
- [ ] íšŒì›ê°€ì…ì´ ì •ìƒ ì‘ë™
- [ ] ì´ë©”ì¼ ì¤‘ë³µ ì²´í¬ ì‘ë™
- [ ] ë¡œê·¸ì¸ì´ ì •ìƒ ì‘ë™
- [ ] ì˜ëª»ëœ ë¹„ë°€ë²ˆí˜¸ ì‹œ ì˜¤ë¥˜ ë©”ì‹œì§€
- [ ] ë¡œê·¸ì•„ì›ƒ í›„ ëŒ€ì‹œë³´ë“œ ì ‘ê·¼ ë¶ˆê°€

**íŒŒì¼ ê´€ë¦¬:**
- [ ] í…ìŠ¤íŠ¸ íŒŒì¼ ì—…ë¡œë“œ ì„±ê³µ
- [ ] PDF íŒŒì¼ ì—…ë¡œë“œ ì„±ê³µ
- [ ] ì§€ì›í•˜ì§€ ì•ŠëŠ” í˜•ì‹ ì—…ë¡œë“œ ì‹œ ì˜¤ë¥˜
- [ ] íŒŒì¼ ëª©ë¡ ì •ìƒ í‘œì‹œ
- [ ] íŒŒì¼ ì‚­ì œ ì •ìƒ ì‘ë™
- [ ] íŒŒì¼ í¬ê¸° ì œí•œ ì‘ë™

**AI ì±„íŒ…:**
- [ ] ì¼ë°˜ ëŒ€í™” ì •ìƒ ì‘ë™
- [ ] íŒŒì¼ ê¸°ë°˜ ì§ˆë¬¸ ì •ìƒ ì‘ë™
- [ ] ì±„íŒ… ê¸°ë¡ ì €ì¥ ë° í‘œì‹œ
- [ ] AI ì„œë¹„ìŠ¤ ì—°ê²° ì‹¤íŒ¨ ì‹œ ì˜¤ë¥˜ ì²˜ë¦¬
- [ ] ë©”ì‹œì§€ ì „ì†¡ ì¤‘ ë¡œë”© í‘œì‹œ

**UI/UX:**
- [ ] ëª¨ë°”ì¼ì—ì„œ ì •ìƒ ì‘ë™
- [ ] ë¸Œë¼ìš°ì € ë’¤ë¡œê°€ê¸° ì •ìƒ ì‘ë™
- [ ] í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨ í›„ ìƒíƒœ ìœ ì§€
- [ ] ì—ëŸ¬ ë©”ì‹œì§€ ì ì ˆíˆ í‘œì‹œ
- [ ] ë¡œë”© ìƒíƒœ ì ì ˆíˆ í‘œì‹œ

### 6-2. ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ ğŸ“Š
```bash
# ê°„ë‹¨í•œ ë¶€í•˜ í…ŒìŠ¤íŠ¸ (curl ì‚¬ìš©)
echo "ë¡œê·¸ì¸ API í…ŒìŠ¤íŠ¸"
for i in {1..10}; do
  time curl -X POST http://localhost:8080/api/auth/login \
    -H "Content-Type: application/json" \
    -d '{"email":"test@example.com","password":"123456"}' \
    -w "\nì‘ë‹µì‹œê°„: %{time_total}ì´ˆ\n"
done

echo "AI ì±„íŒ… API í…ŒìŠ¤íŠ¸"
for i in {1..5}; do
  time curl -X POST http://localhost:8080/api/ai/chat \
    -H "Content-Type: application/json" \
    -d '{"question":"ì•ˆë…•í•˜ì„¸ìš”","userId":1}' \
    -w "\nì‘ë‹µì‹œê°„: %{time_total}ì´ˆ\n"
done
```

### 6-3. ë³´ì•ˆ í…ŒìŠ¤íŠ¸ ğŸ”’
```bash
# SQL ì¸ì ì…˜ í…ŒìŠ¤íŠ¸
curl -X POST http://localhost:8080/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"email":"test@example.com","password":"123456; DROP TABLE users;--"}'

# XSS í…ŒìŠ¤íŠ¸
curl -X POST http://localhost:8080/api/ai/chat \
  -H "Content-Type: application/json" \
  -d '{"question":"<script>alert(\"XSS\")</script>","userId":1}'

# íŒŒì¼ ì—…ë¡œë“œ ì œí•œ í…ŒìŠ¤íŠ¸
# 50MB ì´ìƒ íŒŒì¼ ì—…ë¡œë“œ ì‹œë„
# ì•…ì„± íŒŒì¼ í™•ì¥ì ì—…ë¡œë“œ ì‹œë„
```

## 7. ë¬¸ì œ í•´ê²° ê°€ì´ë“œ

### 7-1. ìì£¼ ë°œìƒí•˜ëŠ” ë¬¸ì œë“¤ ğŸš¨

**ë¬¸ì œ: Docker ì»¨í…Œì´ë„ˆ ì‹¤í–‰ ì‹¤íŒ¨**
```bash
# ë¡œê·¸ í™•ì¸
docker logs smart-learning-ai
docker logs smart-learning-backend

# ì»¨í…Œì´ë„ˆ ìƒíƒœ í™•ì¸
docker ps -a

# ì´ë¯¸ì§€ ì¬ë¹Œë“œ
docker-compose down
docker-compose build --no-cache
docker-compose up -d
```

**ë¬¸ì œ: ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì‹¤íŒ¨**
```bash
# MySQL ì»¨í…Œì´ë„ˆ í™•ì¸
docker exec -it smart-learning-db mysql -u root -p

# ì—°ê²° ì„¤ì • í™•ì¸
docker exec smart-learning-backend cat /app/application.yml
```

**ë¬¸ì œ: AI ì„œë¹„ìŠ¤ ì‘ë‹µ ì—†ìŒ**
```bash
# AI ì„œë¹„ìŠ¤ ë¡œê·¸ í™•ì¸
docker logs smart-learning-ai

# OpenAI API í‚¤ í™•ì¸
docker exec smart-learning-ai env | grep OPENAI

# AI ì„œë¹„ìŠ¤ ì§ì ‘ í…ŒìŠ¤íŠ¸
curl http://localhost:8000/health
```

### 7-2. ëª¨ë‹ˆí„°ë§ ë° ë¡œê¹… ğŸ“Š
```bash
# ì‹¤ì‹œê°„ ë¡œê·¸ ëª¨ë‹ˆí„°ë§
docker-compose logs -f

# íŠ¹ì • ì„œë¹„ìŠ¤ ë¡œê·¸
docker-compose logs -f ai-service
docker-compose logs -f backend

# ì‹œìŠ¤í…œ ë¦¬ì†ŒìŠ¤ í™•ì¸
docker stats

# ë””ìŠ¤í¬ ì‚¬ìš©ëŸ‰ í™•ì¸
docker system df
```

## 8. ë°°í¬ ì¤€ë¹„

### 8-1. í”„ë¡œë•ì…˜ ì„¤ì • âš™ï¸
```yaml
# docker-compose.prod.yml
version: '3.8'

services:
  database:
    environment:
      MYSQL_ROOT_PASSWORD: ${PROD_DB_ROOT_PASSWORD}
      MYSQL_DATABASE: smart_learning_prod
      MYSQL_USER: ${PROD_DB_USER}
      MYSQL_PASSWORD: ${PROD_DB_PASSWORD}
    restart: always

  ai-service:
    environment:
      - OPENAI_API_KEY=${PROD_OPENAI_API_KEY}
    restart: always
    deploy:
      resources:
        limits:
          memory: 1G
        reservations:
          memory: 512M

  backend:
    environment:
      - SPRING_PROFILES_ACTIVE=prod
      - DB_HOST=database
      - DB_USER=${PROD_DB_USER}
      - DB_PASSWORD=${PROD_DB_PASSWORD}
      - JWT_SECRET=${PROD_JWT_SECRET}
    restart: always
    deploy:
      resources:
        limits:
          memory: 1G
        reservations:
          memory: 512M

  frontend:
    restart: always
    deploy:
      resources:
        limits:
          memory: 256M
```

### 8-2. ë°±ì—… ìŠ¤í¬ë¦½íŠ¸ ğŸ’¾
```bash
#!/bin/bash
# backup.sh

DATE=$(date +%Y%m%d_%H%M%S)
BACKUP_DIR="./backups"

mkdir -p $BACKUP_DIR

echo "ğŸ—„ï¸ ë°ì´í„°ë² ì´ìŠ¤ ë°±ì—… ì‹œì‘..."
docker exec smart-learning-db mysqldump -u app_user -papp_password smart_learning_db > $BACKUP_DIR/db_backup_$DATE.sql

echo "ğŸ“ ì—…ë¡œë“œ íŒŒì¼ ë°±ì—… ì‹œì‘..."
docker cp smart-learning-backend:/app/uploads $BACKUP_DIR/uploads_backup_$DATE

echo "âœ… ë°±ì—… ì™„ë£Œ: $BACKUP_DIR"
ls -la $BACKUP_DIR
```

## 9. ë‹¤ìŒ ë‹¨ê³„ (Day 6-7 ì¤€ë¹„)

### 9-1. ë‚´ì¼ í•  ì¼ ğŸ“
- [ ] í´ë¼ìš°ë“œ ì„œë²„ì— ë°°í¬í•˜ê¸°
- [ ] ë„ë©”ì¸ ì„¤ì • ë° HTTPS ì ìš©
- [ ] ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ êµ¬ì¶•
- [ ] ìµœì¢… ë°œí‘œ ìë£Œ ì¤€ë¹„

### 9-2. ì¶”ê°€ ê¸°ëŠ¥ ì•„ì´ë””ì–´ ğŸ’¡
- [ ] íŒŒì¼ë³„ ì±„íŒ… ê¸°ë¡ ë¶„ë¦¬
- [ ] ìŒì„± ì¸ì‹ ì±„íŒ…
- [ ] ë‹¤êµ­ì–´ ì§€ì›
- [ ] í•™ìŠµ ì§„ë„ ëŒ€ì‹œë³´ë“œ
- [ ] ì†Œì…œ ë¡œê·¸ì¸ (Google, GitHub)

### 9-3. ì„±ëŠ¥ ê°œì„  ì•„ì´ë””ì–´ âš¡
- [ ] Redis ìºì‹± ë„ì…
- [ ] CDN ì ìš© (ì´ë¯¸ì§€, ì •ì  íŒŒì¼)
- [ ] ë°ì´í„°ë² ì´ìŠ¤ ì¸ë±ìŠ¤ ìµœì í™”
- [ ] AI ì‘ë‹µ ìŠ¤íŠ¸ë¦¬ë°
- [ ] íŒŒì¼ ì••ì¶• ë° ìµœì í™”