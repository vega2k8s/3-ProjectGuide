# ì»¨í…Œì´ë„ˆí™” ë° ë°°í¬ ê°€ì´ë“œ

## 1. ì»¨í…Œì´ë„ˆ êµ¬ì„±

- **Frontend**: React + Nginx (í¬íŠ¸ 80)
- **Backend**: Spring Boot (í¬íŠ¸ 8080)
- **AI Module**: Python + FastAPI (í¬íŠ¸ 8000)
- **Database**: MariaDB (í¬íŠ¸ 3306)

## 2. Docker ì„¤ì •

### 2.1 Frontend Dockerfile
```dockerfile
# Build stage
FROM node:18-alpine AS build
WORKDIR /app
COPY package*.json ./
RUN npm ci --only=production
COPY . .
RUN npm run build

# Production stage
FROM nginx:alpine
COPY --from=build /app/dist /usr/share/nginx/html
COPY nginx.conf /etc/nginx/nginx.conf
EXPOSE 80
CMD ["nginx", "-g", "daemon off;"]
```

### 2.2 Backend Dockerfile
```dockerfile
FROM openjdk:17-jdk-slim
WORKDIR /app
COPY target/smart-learning-backend-1.0.0.jar app.jar
RUN mkdir -p /app/uploads
EXPOSE 8080
ENTRYPOINT ["java", "-jar", "app.jar"]
```

### 2.3 AI Module Dockerfile
```dockerfile
FROM python:3.11-slim
WORKDIR /app

# ì‹œìŠ¤í…œ ì˜ì¡´ì„± ì„¤ì¹˜
RUN apt-get update && apt-get install -y build-essential curl

COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

COPY src/ ./src/
COPY data/ ./data/

EXPOSE 8000
CMD ["uvicorn", "src.api.main:app", "--host", "0.0.0.0", "--port", "8000"]
```

## 3. Docker Compose

```yaml
version: '3.8'

services:
  database:
    image: mariadb:10.11
    container_name: smart-learning-db
    environment:
      MYSQL_ROOT_PASSWORD: ${DB_ROOT_PASSWORD:-root_password}
      MYSQL_DATABASE: ${DB_NAME:-smart_learning_db}
      MYSQL_USER: ${DB_USER:-app_user}
      MYSQL_PASSWORD: ${DB_PASSWORD:-app_password}
    volumes:
      - db_data:/var/lib/mysql
    ports:
      - "3306:3306"
    networks:
      - app-network

  ai-service:
    build:
      context: ./ai-module
      dockerfile: Dockerfile
    container_name: smart-learning-ai
    environment:
      - OPENAI_API_KEY=${OPENAI_API_KEY}
      - LANGCHAIN_API_KEY=${LANGCHAIN_API_KEY}
      - DATABASE_URL=mysql://${DB_USER:-app_user}:${DB_PASSWORD:-app_password}@database:3306/${DB_NAME:-smart_learning_db}
    volumes:
      - ai_data:/app/data
      - uploaded_documents:/app/uploaded_documents
    ports:
      - "8000:8000"
    depends_on:
      - database
    networks:
      - app-network

  backend:
    build:
      context: ./backend
      dockerfile: Dockerfile
    container_name: smart-learning-backend
    environment:
      - SPRING_PROFILES_ACTIVE=prod
      - DB_HOST=database
      - DB_PORT=3306
      - DB_NAME=${DB_NAME:-smart_learning_db}
      - DB_USER=${DB_USER:-app_user}
      - DB_PASSWORD=${DB_PASSWORD:-app_password}
      - JWT_SECRET=${JWT_SECRET}
      - AI_SERVICE_URL=http://ai-service:8000
    volumes:
      - backend_uploads:/app/uploads
    ports:
      - "8080:8080"
    depends_on:
      - database
      - ai-service
    networks:
      - app-network

  frontend:
    build:
      context: ./frontend
      dockerfile: Dockerfile
    container_name: smart-learning-frontend
    ports:
      - "80:80"
    depends_on:
      - backend
    networks:
      - app-network

volumes:
  db_data:
  ai_data:
  backend_uploads:
  uploaded_documents:

networks:
  app-network:
    driver: bridge
```

## 4. í™˜ê²½ ë³€ìˆ˜

### 4.1 ê°œë°œ í™˜ê²½ (.env.development)
```env
DB_NAME=smart_learning_dev
DB_USER=dev_user
DB_PASSWORD=dev_password
DB_ROOT_PASSWORD=dev_root_password

JWT_SECRET=dev_jwt_secret_key_for_development_only

OPENAI_API_KEY=sk-your-dev-openai-api-key
LANGCHAIN_API_KEY=your-dev-langchain-api-key

REACT_APP_API_URL=http://localhost:8080/api/v1
REACT_APP_AI_URL=http://localhost:8000
```

### 4.2 ìš´ì˜ í™˜ê²½ (.env.production)
```env
DB_NAME=smart_learning_prod
DB_USER=prod_user
DB_PASSWORD=${SECURE_DB_PASSWORD}
DB_ROOT_PASSWORD=${SECURE_ROOT_PASSWORD}

JWT_SECRET=${SECURE_JWT_SECRET}

OPENAI_API_KEY=${SECURE_OPENAI_KEY}
LANGCHAIN_API_KEY=${SECURE_LANGCHAIN_KEY}

REACT_APP_API_URL=https://api.smartlearning.com/api/v1
REACT_APP_AI_URL=https://ai.smartlearning.com
```

## 5. í´ë¼ìš°ë“œ ë°°í¬

### 5.1 AWS EC2 ë°°í¬
```bash
#!/bin/bash
# deploy-aws.sh

echo "ğŸš€ AWS EC2 ë°°í¬ ì‹œì‘..."

# Docker ì„¤ì¹˜
sudo yum update -y
sudo yum install -y docker
sudo service docker start
sudo usermod -a -G docker ec2-user

# Docker Compose ì„¤ì¹˜
sudo curl -L "https://github.com/docker/compose/releases/latest/download/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose
sudo chmod +x /usr/local/bin/docker-compose

# ì• í”Œë¦¬ì¼€ì´ì…˜ ë°°í¬
git clone https://github.com/your-repo/smart-learning-assistant.git
cd smart-learning-assistant

# í™˜ê²½ ë³€ìˆ˜ ì„¤ì •
cp .env.production .env

# ì„œë¹„ìŠ¤ ì‹œì‘
docker-compose up -d

echo "âœ… ë°°í¬ ì™„ë£Œ!"
```

### 5.2 GCP GKE ë°°í¬
```yaml
# k8s/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: smart-learning-backend
spec:
  replicas: 2
  selector:
    matchLabels:
      app: backend
  template:
    metadata:
      labels:
        app: backend
    spec:
      containers:
      - name: backend
        image: gcr.io/PROJECT_ID/backend:latest
        ports:
        - containerPort: 8080
        env:
        - name: DB_HOST
          value: "cloudsql-proxy"
---
apiVersion: v1
kind: Service
metadata:
  name: backend-service
spec:
  selector:
    app: backend
  ports:
  - port: 8080
    targetPort: 8080
  type: LoadBalancer
```

## 6. CI/CD íŒŒì´í”„ë¼ì¸

```yaml
# .github/workflows/deploy.yml
name: CI/CD Pipeline

on:
  push:
    branches: [ main ]

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
    
    - name: Set up Docker Buildx
      uses: docker/setup-buildx-action@v3
    
    - name: Login to registry
      uses: docker/login-action@v3
      with:
        registry: ghcr.io
        username: ${{ github.actor }}
        password: ${{ secrets.GITHUB_TOKEN }}
    
    - name: Build and push images
      run: |
        docker buildx build --platform linux/amd64 -t ghcr.io/${{ github.repository }}/backend:latest --push ./backend
        docker buildx build --platform linux/amd64 -t ghcr.io/${{ github.repository }}/frontend:latest --push ./frontend
        docker buildx build --platform linux/amd64 -t ghcr.io/${{ github.repository }}/ai-service:latest --push ./ai-module
    
    - name: Deploy to production
      run: |
        echo "ë°°í¬ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰"
```

## 7. ë„¤íŠ¸ì›Œí¬

- **Frontend**: 80ë²ˆ í¬íŠ¸ (HTTP)
- **Backend**: 8080ë²ˆ í¬íŠ¸ (Spring Boot)
- **AI Module**: 8000ë²ˆ í¬íŠ¸ (FastAPI)
- **Database**: 3306ë²ˆ í¬íŠ¸ (MariaDB)

## 8. ì™„ë£Œ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] Docker ì´ë¯¸ì§€ ë¹Œë“œ ì„±ê³µ
- [ ] ì»¨í…Œì´ë„ˆ ê°„ ë„¤íŠ¸ì›Œí¬ ì—°ê²° í™•ì¸
- [ ] ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° í™•ì¸
- [ ] AI ëª¨ë“ˆ ì—°ë™ í™•ì¸
- [ ] í—¬ìŠ¤ì²´í¬ ì—”ë“œí¬ì¸íŠ¸ ë™ì‘ í™•ì¸
- [ ] í´ë¼ìš°ë“œ ë°°í¬ ì„±ê³µ
- [ ] ë„ë©”ì¸ ì—°ê²° ë° SSL ì¸ì¦ì„œ ì ìš©